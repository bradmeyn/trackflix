import Head from 'next/head';
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import {
  faMagnifyingGlass,
  faCheck,
  faBookmark,
} from '@fortawesome/pro-regular-svg-icons';
import { useState } from 'react';
import { IMovie } from '@/types/types';
import Card from '@/components/Card';
import Navbar from '@/components/layout/Navbar';
import Footer from '@/components/layout/Footer';
import { Inter } from '@next/font/google';
import { getPopularMovies, getTopRatedMovies } from '@/movieService';
import Carousel from '@/components/Carousel';

const inter = Inter({ subsets: ['latin'] });

export default function Movies({ movies }: { movies: IMovie[] }) {
  const [featuredMovie, setFeaturedMovie] = useState(movies[1]);

  return (
    <>
      <Head>
        <title>Watchflix | Popular</title>
        <meta name='description' content='Generated by create next app' />
        <meta name='viewport' content='width=device-width, initial-scale=1' />
        <link rel='icon' href='/favicon.ico' />
      </Head>
      <div className='min-h-screen flex flex-col grow bg-gradient-to-t from-slate-800 to-slate-900 '>
        <Navbar />
        <main className={'flex flex-col grow '}>
          <div
            className='text-left h-[45rem] p-6  bg-opacity-90 bg-cover bg-no-repeat bg-top flex flex-col '
            style={{
              backgroundImage: `linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, .9)), url(https://image.tmdb.org/t/p/original${featuredMovie.backdrop_path})`,
            }}
          >
            <div className='container mx-auto'>
              <h1 className='text-5xl font-bold mb-5'>{featuredMovie.title}</h1>
              <p className='text-xl font-light mb-5 w-[50rem]'>
                {featuredMovie.overview}
              </p>
              <h2 className='mb-2 font-bold text-white text-xl md:text-2x'>
                Popular Now
              </h2>
              <div className='grid gap-3 grid-flow-col '>
                {movies
                  ? movies.map((movie) => (
                      <Card
                        key={movie.id}
                        id={movie.id}
                        title={movie.title}
                        poster={movie.poster_path}
                      />
                    ))
                  : ''}
              </div>
            </div>
          </div>
          <Carousel
            title={'Highest Rated Movies of All Time'}
            movies={movies}
          />
          <Carousel
            title={'Highest Rated Movies of All Time'}
            movies={movies}
          />
          <Carousel
            title={'Highest Rated Movies of All Time'}
            movies={movies}
          />
          <Carousel
            title={'Highest Rated Movies of All Time'}
            movies={movies}
          />
        </main>
        <Footer />
      </div>
    </>
  );
}

export async function getStaticProps() {
  const response = await getPopularMovies();
  const movies: IMovie[] = response.data.results;

  return {
    props: {
      movies,
    },
  };
}
